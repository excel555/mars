<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">新增首单优惠</h3>
    </div>
    <div class="panel-body">
        <form method="post"  enctype="multipart/form-data" class="form-horizontal"  action="/active/first_save" onsubmit="return submit_model(this);" data-url="/active/first" >
            <div class="form-group">
                <label  class="col-sm-2 control-label">设备ID：</label>
                <div class="col-sm-5">
                    <input type="text" class="form-control" id="box_no" name="box_no" placeholder="设备ID">
                </div>
            </div>
            <div class="form-group">
                <label  class="col-sm-2 control-label">折扣：</label>
                <div class="col-sm-5">
                    <input type="text" class="form-control" name="discount" placeholder="折扣">
                </div>
                <label  class="control-label">%</label>
            </div>
            <!--<div class="form-group">-->
                <!--<label class="col-sm-2 control-label">开始时间：</label>-->
                <!--<div class="col-sm-5">-->
                    <!--<div class="input-group date  col-md-10" data-link-field="dtp_input1" id="time" >-->
                        <!--<input class="form-control" type="text" name="start_time"  placeholder="开始时间"  readonly>-->
                        <!--<span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>-->
                        <!--<span class="input-group-addon"><span class="glyphicon glyphicon-th"></span></span>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="form-group">-->
                <!--<label class="col-sm-2 control-label">结束时间：</label>-->
                <!--<div class="col-sm-5">-->
                    <!--<div class="input-group date  col-md-10" data-link-field="dtp_input2" id="to_date" >-->
                        <!--<input class="form-control" type="text" name="end_time"  placeholder="结束时间"  readonly>-->
                        <!--<span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>-->
                        <!--<span class="input-group-addon"><span class="glyphicon glyphicon-th"></span></span>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
            <div class="form-group">
                <label  class="col-sm-2 control-label">管理员：</label>
                <div class="col-sm-5">
                    <input type="text" class="form-control" name="admin_name" readonly="readonly" value="<{$adminname}>">
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <input class="btn btn-primary" type="submit" value="提交">
                </div>
            </div>
        </form>
    </div>
</div>
<script>
    $(function(){
        $('#time').datetimepicker({
            language: 'zh', //汉化
            autoclose: 1,
            format:'yyyy-mm-dd hh:ii:00',      //格式化日期
            timepicker:false    //关闭时间选项
        });
        $('#to_date').datetimepicker({
            language: 'zh', //汉化
            autoclose: 1,
            format: 'yyyy-mm-dd hh:ii:00',
            timepicker:false    //关闭时间选项
        });
    });

    function submit_model(obj){
        if($(obj).attr('lock') == 1){
            return false;
        }
        $(obj).attr('lock', 1);
        var _url = $(obj).attr('data-url');
        ajaxSubmit(obj, function(data){
            $(obj).attr('lock', 0);
            if(data.status=='success'){
                alert('成功');
                location.href=_url;
            }else{
                alert(data.msg);
                return false;
            }
        });
        return false;
    }
    //将form转为AJAX提交
    function ajaxSubmit(frm, fn) {
        var dataPara = getFormJson(frm);
        $.ajax({
            url: frm.action,
            type: frm.method,
            data: dataPara,
            dataType:'json',
            success: fn
        });
    }

    //将form中的值转换为键值对。
    function getFormJson(frm) {
        var o = {};
        var a = $(frm).serializeArray();
        $.each(a, function () {
            if (o[this.name] !== undefined) {
                if (!o[this.name].push) {
                    o[this.name] = [o[this.name]];
                }
                o[this.name].push(this.value || '');
            } else {
                o[this.name] = this.value || '';
            }
        });
        return o;
    }
</script>